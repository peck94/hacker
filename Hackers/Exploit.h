//
//  Exploit.h
//  Hackers
//
//  Created by Jonathan Peck on 26/07/15.
//  Copyright (c) 2015 Jonathan Peck. All rights reserved.
//

#ifndef __Hackers__Exploit__
#define __Hackers__Exploit__

#include "Vulnerability.h"
#include "Host.h"
#include "Program.h"
#include <string>
#include <memory>
#include <iostream>

/*
 * An exploit is designed to take advantage of a vulnerability in a very specific service.
 * The level of an exploit determines the maximum service version it can hack.
 */
class Exploit: public Program {
private:
    // associated vulnerability
    Vulnerability vuln;
    // exploit level
    unsigned int level;

public:
    // construct an exploit for a vulnerability
    Exploit(std::string name, Vulnerability vuln, unsigned int level);
    
    // getters
    Vulnerability getVuln();
    unsigned int getLevel();
    
    // launch the exploit against a given host
    void launch(Host* host, std::vector<std::string> args);
    
    // actual exploit
    virtual void run(Host *local, Host *remote, unsigned int port) = 0;
};

#endif /* defined(__Hackers__Exploit__) */
